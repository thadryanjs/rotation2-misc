<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.258">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>simulation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="simulation_files/libs/clipboard/clipboard.min.js"></script>
<script src="simulation_files/libs/quarto-html/quarto.js"></script>
<script src="simulation_files/libs/quarto-html/popper.min.js"></script>
<script src="simulation_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="simulation_files/libs/quarto-html/anchor.min.js"></script>
<link href="simulation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="simulation_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="simulation_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="simulation_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="simulation_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#goal" id="toc-goal" class="nav-link active" data-scroll-target="#goal">Goal</a></li>
  <li><a href="#definitions" id="toc-definitions" class="nav-link" data-scroll-target="#definitions">Definitions</a></li>
  <li><a href="#parameters" id="toc-parameters" class="nav-link" data-scroll-target="#parameters">Parameters</a></li>
  <li><a href="#mathematical-functions" id="toc-mathematical-functions" class="nav-link" data-scroll-target="#mathematical-functions">Mathematical Functions</a>
  <ul class="collapse">
  <li><a href="#standard-error-s" id="toc-standard-error-s" class="nav-link" data-scroll-target="#standard-error-s">Standard Error <span class="math inline">\(S\)</span></a></li>
  <li><a href="#standard-error-for-a-batch-s_b" id="toc-standard-error-for-a-batch-s_b" class="nav-link" data-scroll-target="#standard-error-for-a-batch-s_b">Standard Error for a batch <span class="math inline">\(S_b\)</span></a></li>
  <li><a href="#computing-r" id="toc-computing-r" class="nav-link" data-scroll-target="#computing-r">Computing <span class="math inline">\(R\)</span></a></li>
  </ul></li>
  <li><a href="#simulation-functions" id="toc-simulation-functions" class="nav-link" data-scroll-target="#simulation-functions">Simulation Functions</a>
  <ul class="collapse">
  <li><a href="#generate_sample" id="toc-generate_sample" class="nav-link" data-scroll-target="#generate_sample">generate_sample()</a></li>
  <li><a href="#get_batch_info" id="toc-get_batch_info" class="nav-link" data-scroll-target="#get_batch_info">get_batch_info()</a></li>
  <li><a href="#pairwise_comparison" id="toc-pairwise_comparison" class="nav-link" data-scroll-target="#pairwise_comparison">pairwise_comparison()</a></li>
  <li><a href="#run_simulation" id="toc-run_simulation" class="nav-link" data-scroll-target="#run_simulation">run_simulation()</a></li>
  <li><a href="#computecis" id="toc-computecis" class="nav-link" data-scroll-target="#computecis">computeCIs!()</a></li>
  <li><a href="#get_all_rstats" id="toc-get_all_rstats" class="nav-link" data-scroll-target="#get_all_rstats">get_all_rstats()</a></li>
  <li><a href="#get_all_rmax" id="toc-get_all_rmax" class="nav-link" data-scroll-target="#get_all_rmax">get_all_rmax()</a></li>
  <li><a href="#get_d" id="toc-get_d" class="nav-link" data-scroll-target="#get_d">get_d()</a></li>
  <li><a href="#describe_experiment" id="toc-describe_experiment" class="nav-link" data-scroll-target="#describe_experiment">describe_experiment()</a></li>
  </ul></li>
  <li><a href="#the-experiment" id="toc-the-experiment" class="nav-link" data-scroll-target="#the-experiment">The experiment</a>
  <ul class="collapse">
  <li><a href="#using-n" id="toc-using-n" class="nav-link" data-scroll-target="#using-n">Using <span class="math inline">\(N\)</span></a></li>
  <li><a href="#using-k" id="toc-using-k" class="nav-link" data-scroll-target="#using-k">Using <span class="math inline">\(K\)</span></a></li>
  <li><a href="#using-b" id="toc-using-b" class="nav-link" data-scroll-target="#using-b">Using <span class="math inline">\(B\)</span></a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">



<section id="goal" class="level2">
<h2 class="anchored" data-anchor-id="goal">Goal</h2>
<p>To evaluate three different methods for calculating standard error to confirm the correct one for this bootstrap context. Specifically, we will asses weather to use <span class="math inline">\(N\)</span>, <span class="math inline">\(K\)</span>, or <span class="math inline">\(B\)</span> as defined below.</p>
</section>
<section id="definitions" class="level2">
<h2 class="anchored" data-anchor-id="definitions">Definitions</h2>
<ul>
<li><span class="math inline">\(S\)</span>:= the number of samples in the experiment.</li>
<li><span class="math inline">\(N\)</span>:= numbers of observations per sample.</li>
<li><span class="math inline">\(B\)</span>:= number batches (can be thought of as number of bootstraps).</li>
<li><span class="math inline">\(K\)</span>:= number of observations per batch (<span class="math inline">\(\frac{N}{K}\)</span>).</li>
<li><span class="math inline">\(\theta\)</span>:= mean of a sample.</li>
<li><span class="math inline">\(\theta^{b}\)</span>:= mean of a batch (bootstrap).</li>
<li><span class="math inline">\(\sigma\)</span>:= standard deviation of sample.</li>
<li><span class="math inline">\(\sigma_b\)</span>:= standard deviation of a batch.</li>
<li><span class="math inline">\(R\)</span>:= root statistic comparing two means (an empirical mean to a bootstrap).</li>
<li><span class="math inline">\(S\)</span>:= standard error of a sample (“Outer SE”).</li>
<li><span class="math inline">\(S_b\)</span>:= standard error use in the calculation of <span class="math inline">\(R\)</span> (“Inner SE”).</li>
<li><span class="math inline">\(\alpha\)</span>:= significance level of a comparison.</li>
<li><span class="math inline">\(d\)</span>:= <span class="math inline">\(1-\alpha\)</span> quantile of a vector of <span class="math inline">\(R\)</span>s.</li>
<li><span class="math inline">\(Z\)</span>:= <span class="math inline">\(\in [N,B,K]\)</span>, factor to test the use of in the function.</li>
</ul>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">HypothesisTests</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">PlotThemes; </span><span class="fu">theme</span>(<span class="op">:</span>dracula)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrames</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CSV</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LaTeXStrings</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="parameters" class="level2">
<h2 class="anchored" data-anchor-id="parameters">Parameters</h2>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Random</span>.<span class="fu">seed!</span>(<span class="fl">8675309</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># observations per sample</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">100000</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># number of batches</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> <span class="fl">100</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># observations per batch</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> <span class="fl">1000</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># number of samples</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> <span class="fl">17</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># transparently display what we're using </span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(S, <span class="st">" samples per experiment"</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(N, <span class="st">" observations per sample (N)"</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(B, <span class="st">" batches per subpopulation/bootstrap (B)"</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(K, <span class="st">" observations per batch (K)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>17 samples per experiment
100000 observations per sample (N)
100 batches per subpopulation/bootstrap (B)
1000 observations per batch (K)</code></pre>
</div>
</div>
</section>
<section id="mathematical-functions" class="level2">
<h2 class="anchored" data-anchor-id="mathematical-functions">Mathematical Functions</h2>
<p>These are the functions we’re using for math calculations (as opposed to the programmatic, automation/simulation functions).</p>
<section id="standard-error-s" class="level3">
<h3 class="anchored" data-anchor-id="standard-error-s">Standard Error <span class="math inline">\(S\)</span></h3>
<p>The classical standard error.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the standard error</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">standard_error</span>(sd1, sd2, N)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>( ( (sd1<span class="op">^</span><span class="fl">2</span>) <span class="op">+</span> (sd2<span class="op">^</span><span class="fl">2</span>) ) <span class="op">*</span> (N<span class="op">^-</span><span class="fl">1</span>) )</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="734">
<pre><code>standard_error (generic function with 1 method)</code></pre>
</div>
</div>
</section>
<section id="standard-error-for-a-batch-s_b" class="level3">
<h3 class="anchored" data-anchor-id="standard-error-for-a-batch-s_b">Standard Error for a batch <span class="math inline">\(S_b\)</span></h3>
<p>The standard error modified for our tests</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Z will be either N, M, K</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">standard_error_boot</span>(sd1, sd2, Z)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>( ( (sd1<span class="op">^</span><span class="fl">2</span>) <span class="op">+</span> (sd2<span class="op">^</span><span class="fl">2</span>) ) <span class="op">*</span> (Z<span class="op">^-</span><span class="fl">1</span>) )</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="735">
<pre><code>standard_error_boot (generic function with 1 method)</code></pre>
</div>
</div>
</section>
<section id="computing-r" class="level3">
<h3 class="anchored" data-anchor-id="computing-r">Computing <span class="math inline">\(R\)</span></h3>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the root statistic</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">calc_root_stat</span>(m1, m1b, m2, m2b, se)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    ( (m1b <span class="op">-</span> m2b) <span class="op">-</span> (m1 <span class="op">-</span> m2) ) <span class="op">/</span> se </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="736">
<pre><code>calc_root_stat (generic function with 1 method)</code></pre>
</div>
</div>
</section>
</section>
<section id="simulation-functions" class="level2">
<h2 class="anchored" data-anchor-id="simulation-functions">Simulation Functions</h2>
<p>We will write a function to generate a sample.</p>
<section id="generate_sample" class="level3">
<h3 class="anchored" data-anchor-id="generate_sample">generate_sample()</h3>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a sample of normal data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">generate_sample</span>(mu, sd, N) <span class="op">=</span> <span class="fu">rand</span>(<span class="fu">Normal</span>(mu, sd), N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="737">
<pre><code>generate_sample (generic function with 1 method)</code></pre>
</div>
</div>
<section id="example" class="level4">
<h4 class="anchored" data-anchor-id="example">Example</h4>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test samples to test/demonstrate the functions on</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>test_samples <span class="op">=</span> [<span class="fu">generate_sample</span>(<span class="fl">2</span>, <span class="fl">0.5</span>, N) for i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect the first ten observations of the first of the 3 samples</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">first</span>(test_samples[<span class="fl">1</span>], <span class="fl">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="738">
<pre><code>10-element Vector{Float64}:
 2.353160068039333
 1.8167144960398673
 1.9095417622268083
 1.6576805780294568
 1.8620788432206343
 2.2309948184384742
 2.263882041713389
 2.834016157446034
 1.9437292015569316
 2.2105173016335384</code></pre>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make sure the same looks as it should</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(test_samples[<span class="fl">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="739">
<p><img src="simulation_files/figure-html/cell-9-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>I will now write a separate function to get the information about sample needed to make a comparison to another sample.</p>
</section>
</section>
<section id="get_batch_info" class="level3">
<h3 class="anchored" data-anchor-id="get_batch_info">get_batch_info()</h3>
<p>This function takes a sample in the form of a vector, and gets bootstrapped samples by dividing the vector into <span class="math inline">\(B\)</span> batches of <span class="math inline">\(K\)</span>. It then gets the <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\sigma\)</span> of those batches and thus returns vectors of <span class="math inline">\(B\)</span> <span class="math inline">\(\theta_b\)</span>s and <span class="math inline">\(\sigma_b\)</span>s. It also gets the sample <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\sigma\)</span>, which the bootstrapped values will be compared against. It also names the sample so that any given sample can be looked up again if needed. It returns a dictionary.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">### will conduct batch bootstrapping and collect relevant data on the sample</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">get_batch_info</span>(sample, sample_name, K)    </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># arrays to store means and SDs</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    theta_boots <span class="op">=</span> []</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    sd_boots <span class="op">=</span> []</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># this algorithm indexes arrays at...</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1-100</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 101-200</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 201-300</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># etc</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    i <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>B</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># the upper limits, ie, 1-100</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> i  <span class="op">+</span> (K<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>        batch <span class="op">=</span> sample[i<span class="op">:</span>j]</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>        <span class="co">### println("from ", i, " to ", j)</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># collect the figures</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">push!</span>(theta_boots, <span class="fu">mean</span>(batch))</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">push!</span>(sd_boots, <span class="fu">std</span>(batch))</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># increase by the batch size the set the next limit</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        i <span class="op">+=</span> K </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Dict</span>(</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">"name"</span> <span class="op">=&gt;</span> sample_name,</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">"mean"</span> <span class="op">=&gt;</span> <span class="fu">mean</span>(sample),</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">"sd"</span> <span class="op">=&gt;</span> <span class="fu">std</span>(sample),</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"bootstrap_means"</span> <span class="op">=&gt;</span> theta_boots,</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">"bootstrap_sds"</span> <span class="op">=&gt;</span> sd_boots</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="740">
<pre><code>get_batch_info (generic function with 1 method)</code></pre>
</div>
</div>
<section id="example-1" class="level4">
<h4 class="anchored" data-anchor-id="example-1">Example</h4>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>test_samples <span class="op">=</span> [</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_batch_info</span>(test_samples[<span class="fl">1</span>], <span class="st">"sample1"</span>, K),</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_batch_info</span>(test_samples[<span class="fl">2</span>], <span class="st">"sample2"</span>, K),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_batch_info</span>(test_samples[<span class="fl">3</span>], <span class="st">"sample3"</span>, K)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>test_samples[<span class="fl">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="741">
<pre><code>Dict{String, Any} with 5 entries:
  "name"            =&gt; "sample1"
  "bootstrap_sds"   =&gt; Any[0.498189, 0.500786, 0.507715, 0.510555, 0.509852, 0.…
  "bootstrap_means" =&gt; Any[2.00983, 2.00295, 1.99741, 1.98588, 2.03461, 2.00189…
  "mean"            =&gt; 1.9988
  "sd"              =&gt; 0.498694</code></pre>
</div>
</div>
</section>
</section>
<section id="pairwise_comparison" class="level3">
<h3 class="anchored" data-anchor-id="pairwise_comparison">pairwise_comparison()</h3>
<p>This function makes the pairwise comparisons between samples given two samples, it iterates through their bootstrapped <span class="math inline">\(\theta\)</span> s and <span class="math inline">\(\sigma\)</span> s. Thus, it will make <span class="math inline">\(B\)</span> comparisons - the <span class="math inline">\(\theta_s\)</span> against every <span class="math inline">\(\theta_b\)</span>, ie for <span class="math inline">\(B=10\)</span>:</p>
<ul>
<li><span class="math inline">\(\theta_s \space\)</span> vs
<ul>
<li><span class="math inline">\(\theta_{b1}\)</span></li>
<li><span class="math inline">\(\theta_{b2}\)</span></li>
<li><span class="math inline">\(\theta_{b3}\)</span></li>
<li><span class="math inline">\(\theta_{b4}\)</span></li>
<li><span class="math inline">\(\theta_{b5}\)</span></li>
<li><span class="math inline">\(\theta_{b6}\)</span></li>
<li><span class="math inline">\(\theta_{b7}\)</span></li>
<li><span class="math inline">\(\theta_{b8}\)</span></li>
<li><span class="math inline">\(\theta_{b9}\)</span></li>
<li><span class="math inline">\(\theta_{b10}\)</span></li>
</ul></li>
</ul>
<p>The <span class="math inline">\(Z\)</span> is where the experiment takes place. This value is passed to the standard error function for use as the denominator. We will asses the distribution of the test statistic when different values for <span class="math inline">\(Z\)</span> are used. Returns a vector of <span class="math inline">\(R\)</span> stats.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">### makes comparisons and returns a vector of R statistics</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">### z is the N, K, or M we're testing</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">pairwise_comparison</span>(sample1, sample2, Z)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get relevant sample information</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    s1_theta <span class="op">=</span> sample1[<span class="st">"mean"</span>]</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    s1_theta_boots <span class="op">=</span> sample1[<span class="st">"bootstrap_means"</span>]</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    s1_sd_boots <span class="op">=</span> sample1[<span class="st">"bootstrap_sds"</span>]</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    s2_theta <span class="op">=</span> sample2[<span class="st">"mean"</span>]</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    s2_theta_boots <span class="op">=</span> sample2[<span class="st">"bootstrap_means"</span>]</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    s2_sd_boots <span class="op">=</span> sample2[<span class="st">"bootstrap_sds"</span>]</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># a vector to collect the R statistics</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    R_stats <span class="op">=</span> []</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the number of iterations must match the number of batches, B</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>B</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># get the standard error using the current batch sd</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        se <span class="op">=</span> <span class="fu">standard_error</span>(s1_sd_boots[i], s2_sd_boots[i], Z)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># pass the sample thetas to compare to this particular bootstrap value</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>        R <span class="op">=</span> <span class="fu">calc_root_stat</span>(s1_theta, s1_theta_boots[i],</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>                            s2_theta, s2_theta_boots[i], se)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">push!</span>(R_stats, R)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    R_stats</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="742">
<pre><code>pairwise_comparison (generic function with 1 method)</code></pre>
</div>
</div>
<section id="example-2" class="level4">
<h4 class="anchored" data-anchor-id="example-2">Example</h4>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise_comparison</span>(test_samples[<span class="fl">1</span>], test_samples[<span class="fl">2</span>], N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="743">
<pre><code>100-element Vector{Any}:
   8.488359318064447
   7.632618501280632
  -8.211381683575341
 -14.923760157195
  12.507945183317743
  -4.5755293111610085
  13.243533672331248
  15.897839225628035
  -5.093609483915427
  18.32439607987847
 -22.225481158000655
  -4.7874745431862
  -4.211541553875931
   ⋮
  16.305060085342927
  -9.62663038479756
  -6.649675125965371
 -14.430706025120056
 -10.858938605517043
   2.95694149992945
  -4.573723028046325
  -7.529313662227213
  10.42478957400256
   8.024927738051394
   9.495656953100239
  -0.9170568110987096</code></pre>
</div>
</div>
</section>
</section>
<section id="run_simulation" class="level3">
<h3 class="anchored" data-anchor-id="run_simulation">run_simulation()</h3>
<p>This function actually runs the simulation on a group of samples. It simples takes a list of samples and the <span class="math inline">\(Z\)</span> that we’re investigating to pass to the <code>pairwise_comparison()</code> function. It returns a dict of information to be passed onto the next function. The key new information it returns is a vector of root statistics, in particular noting the maximum.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">### runs pairwise_comparison on a list of samples, skipping redundant comparisons,</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">run_simulation</span>(samples, Z)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># we will make a string describing the comparison we're doing so</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># we can check for redundancies</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    comparison <span class="op">=</span> []</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># info we'll return</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    r_stats_dict <span class="op">=</span> <span class="fu">Dict</span>()</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for every sample...</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(samples)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># for every sample...</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span>(samples)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>            <span class="co"># don't compare 1 to 1</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">!=</span> j</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>                <span class="co"># note the comparison for the record</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>                c <span class="op">=</span> <span class="fu">string</span>(i, <span class="st">"_vs_"</span>, j)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>                <span class="co"># add the comparison we just made it</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>                <span class="fu">push!</span>(comparison, c)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>                <span class="co"># check for the reverse comparison - don't compare 2-1 if we've</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>                <span class="co"># done 1-2 ie, don't compare i to j if we've compared j to i</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="fu">string</span>(j, <span class="st">"_vs_"</span>, i) <span class="kw">in</span> comparison</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">continue</span> <span class="co"># skip this iteration</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>                <span class="cf">end</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>                <span class="co"># unpack what we'll need</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>                s1 <span class="op">=</span> samples[i]</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>                s2 <span class="op">=</span> samples[j]</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>                m1 <span class="op">=</span> s1[<span class="st">"mean"</span>]</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>                m2 <span class="op">=</span> s2[<span class="st">"mean"</span>]</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>                sd1 <span class="op">=</span> s1[<span class="st">"sd"</span>]</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>                sd2 <span class="op">=</span> s2[<span class="st">"sd"</span>]</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>                <span class="co">## dev: inefficient but usable for this quick refactor</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>                <span class="co">## return the r stat and the other things we will need</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>                <span class="co"># make the pairwise comparisons of all the sample means</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>                <span class="co"># against all of the bootstrap/batch means</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>                r_stats <span class="op">=</span> <span class="fu">pairwise_comparison</span>(s1, s2, Z)</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>                r_stats_dict[c] <span class="op">=</span> <span class="fu">Dict</span>(</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"max_r_stat"</span> <span class="op">=&gt;</span> <span class="fu">abs</span>(<span class="fu">maximum</span>(r_stats)),</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"r_stats_vector"</span> <span class="op">=&gt;</span> r_stats,</span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># we will need these again later</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"m1"</span> <span class="op">=&gt;</span> m1,</span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"m2"</span> <span class="op">=&gt;</span> m2,</span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"sd1"</span> <span class="op">=&gt;</span> sd1,</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"sd2"</span> <span class="op">=&gt;</span> sd2</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>    r_stats_dict</span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="744">
<pre><code>run_simulation (generic function with 1 method)</code></pre>
</div>
</div>
<section id="example-3" class="level4">
<h4 class="anchored" data-anchor-id="example-3">Example</h4>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">run_simulation</span>(test_samples, N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="745">
<pre><code>Dict{Any, Any} with 3 entries:
  "2_vs_3" =&gt; Dict{String, Any}("m2"=&gt;2.00153, "r_stats_vector"=&gt;Any[-2.05972, …
  "1_vs_3" =&gt; Dict{String, Any}("m2"=&gt;2.00153, "r_stats_vector"=&gt;Any[6.38693, 1…
  "1_vs_2" =&gt; Dict{String, Any}("m2"=&gt;2.00125, "r_stats_vector"=&gt;Any[8.48836, 7…</code></pre>
</div>
</div>
</section>
</section>
<section id="computecis" class="level3">
<h3 class="anchored" data-anchor-id="computecis">computeCIs!()</h3>
<p>This function takes the results of <code>run_simulation()</code> and computes the confidence intervals for each comparison. It just adds on to the object it received. These keeps the <code>run_simulation()</code> function a little cleaner.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this takes the comparison records and adds</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">computeCIs!</span>(o, alpha, N)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get a vector of all the absolute value of max r stats</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    r_stats <span class="op">=</span> [v[<span class="st">"max_r_stat"</span>] for (k,v) <span class="kw">in</span> o]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for each comparison</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (k,v) <span class="kw">in</span> o</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># note the value we need</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        m1 <span class="op">=</span> v[<span class="st">"m1"</span>]</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>        m2 <span class="op">=</span> v[<span class="st">"m2"</span>]</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        sd1 <span class="op">=</span> v[<span class="st">"sd1"</span>]</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        sd2 <span class="op">=</span> v[<span class="st">"sd2"</span>]</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># compute d and the sample (non-bootstrap) standard error</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        d <span class="op">=</span> <span class="fu">quantile</span>(r_stats, (<span class="fl">1</span><span class="op">-</span>alpha))</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>        se <span class="op">=</span> <span class="fu">standard_error</span>(sd1, sd2, N)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># add the new information to the record we have</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>        v[<span class="st">"d"</span>] <span class="op">=</span> d</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>        v[<span class="st">"low"</span>] <span class="op">=</span> <span class="fu">round</span>( (m1 <span class="op">-</span> m2) <span class="op">-</span> (d <span class="op">*</span> se), digits <span class="op">=</span> <span class="fl">5</span>) </span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>        v[<span class="st">"obs"</span>] <span class="op">=</span> <span class="fu">round</span>( (m1 <span class="op">-</span> m2), digits <span class="op">=</span> <span class="fl">5</span>)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>        v[<span class="st">"high"</span>] <span class="op">=</span> <span class="fu">round</span>( (m1 <span class="op">-</span> m2) <span class="op">+</span> (d <span class="op">*</span> se), digits <span class="op">=</span> <span class="fl">5</span>)</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    o</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="746">
<pre><code>computeCIs! (generic function with 1 method)</code></pre>
</div>
</div>
</section>
<section id="get_all_rstats" class="level3">
<h3 class="anchored" data-anchor-id="get_all_rstats">get_all_rstats()</h3>
<p>A convenience function to get all the <span class="math inline">\(R\)</span> stats (not <span class="math inline">\(R_{max}\)</span> s) in an experiment.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">### get all the r stats in an experiment</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">get_all_rstats</span>(o)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    all_r_stats <span class="op">=</span> []</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(k,v) <span class="kw">in</span> o</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>        vec <span class="op">=</span> v[<span class="st">"r_stats_vector"</span>]</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> vec</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">push!</span>(all_r_stats, i)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    all_r_stats</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="747">
<pre><code>get_all_rstats (generic function with 1 method)</code></pre>
</div>
</div>
</section>
<section id="get_all_rmax" class="level3">
<h3 class="anchored" data-anchor-id="get_all_rmax">get_all_rmax()</h3>
<p>A convenience function to get all the <span class="math inline">\(R_{max}\)</span> values in an experiment.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">### get all the r max values in an experiment</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">get_all_rmax</span>(o)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    all_r_maxes <span class="op">=</span> []</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (k,v) <span class="kw">in</span> o</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">push!</span>(all_r_maxes, v[<span class="st">"max_r_stat"</span>])</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    all_r_maxes</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="748">
<pre><code>get_all_rmax (generic function with 1 method)</code></pre>
</div>
</div>
</section>
<section id="get_d" class="level3">
<h3 class="anchored" data-anchor-id="get_d">get_d()</h3>
<p>Gets the <span class="math inline">\(d\)</span> of an experiment. Because it’s stored multiple times, it’s inefficient but not so much it matters.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">### get the d for an experiment</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">get_d</span>(o)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    [v[<span class="st">"d"</span>] for (k,v) <span class="kw">in</span> o][<span class="fl">1</span>]</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="749">
<pre><code>get_d (generic function with 1 method)</code></pre>
</div>
</div>
</section>
<section id="describe_experiment" class="level3">
<h3 class="anchored" data-anchor-id="describe_experiment">describe_experiment()</h3>
<p>This function shows numerical and visual results of interest from the experiment passed to it. It prints metrics and returns graphs.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">describe_experiment</span>(sim)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get the r stats</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    r_stats <span class="op">=</span> <span class="fu">get_all_rstats</span>(sim)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    r_max <span class="op">=</span> <span class="fu">get_all_rmax</span>(sim)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print some QC metrics of interest</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"d: "</span>, <span class="fu">get_d</span>(sim))</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Number of R stats: "</span>, <span class="fu">length</span>(r_stats))</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"Number of max R stats: "</span>, <span class="fu">length</span>(r_max))</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"17*8*B: "</span>, <span class="fl">17</span> <span class="op">*</span> <span class="fl">8</span> <span class="op">*</span> B)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">println</span>(<span class="st">"((S-1)/2 * B): "</span>,  (S <span class="op">*</span> (S<span class="op">-</span><span class="fl">1</span>) <span class="op">/</span><span class="fl">2</span> ) <span class="op">*</span> B)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># visualize the r stats</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    r_hist <span class="op">=</span> <span class="fu">histogram</span>(</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>        r_stats,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>        title <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Distribution of "</span>, L<span class="st">"R"</span>),</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>        label <span class="op">=</span> L<span class="st">"R"</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>    r_max_hist <span class="op">=</span> <span class="fu">histogram</span>(</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>        r_max,</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>        title <span class="op">=</span> <span class="fu">string</span>(<span class="st">"Distribution of "</span>, L<span class="st">"R_{max}"</span>),</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>        label <span class="op">=</span> L<span class="st">"</span><span class="sc">$</span>R_<span class="st">{max}</span><span class="sc">$</span><span class="st">"</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="st">    )</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="st">    </span>plot<span class="st">(r_hist, r_max_hist, layout = (2,1))</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="750">
<pre><code>describe_experiment (generic function with 1 method)</code></pre>
</div>
</div>
</section>
</section>
<section id="the-experiment" class="level2">
<h2 class="anchored" data-anchor-id="the-experiment">The experiment</h2>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> []</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>S</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># make a sample</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> <span class="fu">generate_sample</span>(<span class="fl">2</span>, <span class="fl">0.5</span>, N)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get a report on that sample</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    sample_info <span class="op">=</span> <span class="fu">get_batch_info</span>(s, <span class="fu">string</span>(<span class="st">"sample"</span>, i), K)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">push!</span>(samples, sample_info)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="co"># exit if there is disagreement between the number</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="co"># of samples and the desired amount</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="pp">@assert</span> samples <span class="op">|&gt;</span> length <span class="op">==</span> S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="using-n" class="level3">
<h3 class="anchored" data-anchor-id="using-n">Using <span class="math inline">\(N\)</span></h3>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>sim_N <span class="op">=</span> <span class="fu">run_simulation</span>(samples, N)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>sim_N <span class="op">=</span> <span class="fu">computeCIs!</span>(sim_N, <span class="fl">0.05</span>, N)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">describe_experiment</span>(sim_N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>d: 32.05737834010711
Number of R stats: 13600
Number of max R stats: 136
17*8*B: 13600
((S-1)/2 * B): 13600.0</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="752">
<p><img src="simulation_files/figure-html/cell-22-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="using-k" class="level3">
<h3 class="anchored" data-anchor-id="using-k">Using <span class="math inline">\(K\)</span></h3>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>sim_K <span class="op">=</span> <span class="fu">run_simulation</span>(samples, K)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>sim_K <span class="op">=</span> <span class="fu">computeCIs!</span>(sim_K, <span class="fl">0.05</span>, N)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">describe_experiment</span>(sim_K)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>d: 3.205737834010711
Number of R stats: 13600
Number of max R stats: 136
17*8*B: 13600
((S-1)/2 * B): 13600.0</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="753">
<p><img src="simulation_files/figure-html/cell-23-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="using-b" class="level3">
<h3 class="anchored" data-anchor-id="using-b">Using <span class="math inline">\(B\)</span></h3>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>sim_B <span class="op">=</span> <span class="fu">run_simulation</span>(samples, B)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>sim_B <span class="op">=</span> <span class="fu">computeCIs!</span>(sim_B, <span class="fl">0.05</span>, N)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">describe_experiment</span>(sim_B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>d: 1.0137433136848641
Number of R stats: 13600
Number of max R stats: 136
17*8*B: 13600
((S-1)/2 * B): 13600.0</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="754">
<p><img src="simulation_files/figure-html/cell-24-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>